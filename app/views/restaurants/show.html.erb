<%= render 'shared/header' %>

<div class="body">
  <input type="hidden" id="address" value="<%= @restaurant.address %>">
  
  <div class="show_restaurant_wrapper">
    <div class="show_header">
      
      <div class="show_header_image">
        <%= image_tag @headerimage + "_header.jpg" %>
      </div>
      <div class="show_header_title">
        <h1><%= @restaurant.name %></h1>
      </div>

      <div class="reservation_container">
        <canvas id="reservationCanvas"></canvas>
        <h3>Make a Reservation:</h3>
        <%= render 'shared/reservation_form' %>
      </div>


    </div>

   
    <div class="show_body_firstrow">
      <div class="show_body_left">
        <h2>Restaurant Details</h2>
        <div class="stats_container">
          <ul>
            <li><strong>Cuisine:</strong> <%= @restaurant.cuisine %></li>
            <li><strong>Location:</strong> <%= @restaurant.location %></li>
            <li><strong>Price:</strong> $$$</li>
          </ul>
        </div>
        <p class="show_restaurant_description">
          <strong>About <%= @restaurant.name %>:</strong> <%= @restaurant.description %>
          <br><br><br>
          <span style="font-size: 0.9em">
            <strong style="color: #2692be">Restaurant Address:</strong> <%= @restaurant.address %>
          </span>
        </p>
      </div>
      <div id="map-canvas"></div>
    </div>
  
    <div class="show_body_secondrow">
      <div class="show_reviews">
        <h1>REVIEWS</h1>

<% if @reviews.length>0 ; @reviews.each do |review| %>

    <p><%= review.title %></p>
    <p><%= review.content %></p>
    <p><%= review.rating %></p>
    <p>Reviewed by <%= review.user.first_name.capitalize %> on <%= review.created_at %> </p>

<% end; end %>

<%= form_for [@restaurant, @restaurant.reviews.new] do |f| %>

    <p><%= f.label 'title', 'Review Title' %></p>
    <p><%= f.text_field 'title' %></p>

    <p><%= f.label 'content', "Review" %></p>
    <p><%= f.text_area 'content' %></p>

    <p><%= f.label 'rating_1', '1' %>
        <%= f.radio_button 'rating', 1 %>
        <%= f.label 'rating_2', '2' %>
        <%= f.radio_button 'rating', 2 %>
        <%= f.label 'rating_3', '3' %>
        <%= f.radio_button 'rating', 3 %>
        <%= f.label 'rating_4', '4' %>
        <%= f.radio_button 'rating', 4 %>
        <%= f.label 'rating_5', '5' %>
        <%= f.radio_button 'rating', 5 %></p>

    <%= f.hidden_field 'user_id', value:session[:user_id] %>
    <p><%= f.submit 'Submit your review now' %></p>


<% end %>


      </div>
    </div>


  </div>

</div>






<script>
 geocoder = new google.maps.Geocoder();


    //In this case it gets the address from an element on the page, but obviously you  could just pass it to the method instead
function initialize() {

  var address = document.getElementById("address").value;


  geocoder.geocode( { 'address': address}, function(results, status) {
    if (status == google.maps.GeocoderStatus.OK) {
      //In this case it creates a marker, but you can get the lat and lng from the location.LatLng

      var myLatlng = new google.maps.LatLng(results[0].geometry.location.lat(), results[0].geometry.location.lng());

      var mapOptions = {
        center: myLatlng,
        zoom: 16
      };
      
      var map = new google.maps.Map(document.getElementById("map-canvas"),
          mapOptions);


      var marker = new google.maps.Marker({
          position: myLatlng,
          map: map,
          draggable:true,
          title: ""
      });
      marker.setTitle("<%= @restaurant.name %>");
      markers.push(newMarker);
    } else {
      alert("Geocode was not successful for the following reason: " + status);
    }
  });

}


initialize();


document.getElementById('reservationCanvas').patternizer(
  {
    stripes : [ 
        {
            color: '#63d6ff',
            rotation: 45,
            opacity: 37,
            mode: 'normal',
            width: 41,
            gap: 40,
            offset: 0
        },
        {
            color: '#b9e7f6',
            rotation: 45,
            opacity: 50,
            mode: 'normal',
            width: 25,
            gap: 25,
            offset: 0
        }
    ],
    bg : '#427b95'
  }
);

</script>


